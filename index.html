<!DOCTYPE html>
<html lang="sr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STEM Laboratorija | Kviz i Baza</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Outfit:wght@300;600;800&display=swap');
        body { font-family: 'Outfit', sans-serif; scroll-behavior: smooth; }
        .step { display: none; }
        .step-active { display: block; animation: fadeIn 0.5s ease; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        .tab-active { background-color: #4F46E5 !important; color: white !important; transform: scale(1.05); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .card-hover { transition: all 0.3s ease; }
        .card-hover:hover { transform: translateY(-10px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1); }
        .hidden { display: none; }
    </style>
</head>
<body class="bg-slate-50 min-h-screen">

<iframe name="hidden_iframe" id="hidden_iframe" style="display:none;"></iframe>

<div id="quiz-container" class="min-h-screen flex items-center justify-center p-4">
    <div class="max-w-2xl w-full bg-white rounded-[3rem] shadow-2xl p-8 md:p-12 border border-white">
        <div id="step-0" class="step step-active text-center">
            <h2 class="text-3xl font-extrabold text-gray-800 mb-6 font-bold">Pokreni STEM test i otključaj eksperimente ☄️</h2>
            <form action="https://script.google.com/macros/s/AKfycbxZM9OWV6HrNk5I1KzFIFiAvAkeyXgoA3zZI_tAZUSOcCFWXTKg1W8JdOiDnnwUnp3KyQ/exec" 
                  method="POST" target="hidden_iframe" onsubmit="return startQuiz();">
                <div class="space-y-4 text-left">
                    <input type="text" name="ime" placeholder="Vaše ime" required class="w-full p-4 rounded-2xl border-2 border-gray-100 focus:border-indigo-500 outline-none bg-gray-50">
                    <input type="email" name="email" placeholder="E-mail adresa" required class="w-full p-4 rounded-2xl border-2 border-gray-100 focus:border-indigo-500 outline-none bg-gray-50">
                    <input type="text" name="zanimanje" placeholder="Zanimanje" required class="w-full p-4 rounded-2xl border-2 border-gray-100 focus:border-indigo-500 outline-none bg-gray-50">
                    <button type="submit" class="w-full bg-indigo-600 text-white font-bold py-5 rounded-2xl hover:bg-indigo-700 shadow-xl transition-all uppercase tracking-widest mt-4">Otključaj bazu</button>
                </div>
            </form>
        </div>
        <div id="step-1" class="step text-center">
            <div id="q-progress" class="text-indigo-500 font-bold mb-4 uppercase text-sm tracking-widest"></div>
            <h3 id="q-text" class="text-2xl font-bold text-gray-800 mb-8 leading-tight italic"></h3>
            <div id="q-options" class="grid gap-3"></div>
        </div>
        <div id="step-2" class="step text-center">
            <div class="text-6xl text-green-500 mb-6"><i class="fas fa-check-circle"></i></div>
            <h2 class="text-3xl font-bold text-gray-800 mb-8 text-indigo-900 uppercase font-bold">Sve je spremno!</h2>
            <button onclick="prikaziBazu()" class="bg-indigo-600 text-white font-bold py-5 px-10 rounded-2xl shadow-xl w-full uppercase tracking-widest hover:bg-indigo-700 transition-all">POGLEDAJ EKSPERIMENTE</button>
        </div>
    </div>
</div>

<div id="database-section" class="hidden">
    <header class="bg-indigo-700 text-white py-16 px-6 shadow-2xl rounded-b-[4rem] text-center mb-12">
        <div class="max-w-4xl mx-auto">
            <h1 class="text-5xl md:text-7xl font-bold mb-6 tracking-tight">STEM Laboratorija</h1>
            <p class="text-indigo-100 text-xl opacity-90 uppercase tracking-widest font-semibold italic">Nauka prilagođena uzrastu</p>
        </div>
    </header>
    <main class="max-w-6xl mx-auto px-4">
        <div class="flex flex-wrap justify-center gap-4 mb-10 text-white font-bold uppercase">
            <button onclick="prikazi('predskolci', this)" class="cat-btn bg-white text-indigo-700 px-8 py-4 rounded-2xl font-bold shadow-md hover:shadow-lg transition-all border-2 border-transparent italic">PREDŠKOLCI (3-6)</button>
            <button onclick="prikazi('osnovci', this)" class="cat-btn bg-white text-indigo-700 px-8 py-4 rounded-2xl font-bold shadow-md hover:shadow-lg transition-all border-2 border-transparent italic">OSNOVCI (7-14)</button>
            <button onclick="prikazi('srednjoskolci', this)" class="cat-btn bg-white text-indigo-700 px-8 py-4 rounded-2xl font-bold shadow-md hover:shadow-lg transition-all border-2 border-transparent italic">SREDNJOŠKOLCI (15+)</button>
        </div>
        <div id="vaznost-sekcija" class="bg-indigo-50 p-8 rounded-3xl mb-12 text-center border border-indigo-100 shadow-inner">
            <h2 class="text-2xl font-bold text-indigo-800 mb-3 italic uppercase">Zašto je nauka važna?</h2>
            <p id="tekst-vaznosti" class="text-indigo-900 text-lg leading-relaxed font-medium"></p>
        </div>
        <div id="ekran" class="grid md:grid-cols-2 lg:grid-cols-3 gap-8 pb-20"></div>
    </main>
</div>

<script>
    const podaci = {
        vaznost: {
            predskolci: "Za najmlađe, nauka je čista igra koja budi čula. Kroz eksperimente deca uče da posmatraju svet i razvijaju finu motoriku.",
            osnovci: "Osnovci kroz praktičan rad povezuju školsko gradivo sa stvarnim životom. Nauka im pomaže da razumeju svet oko sebe.",
            srednjoskolci: "Srednjoškolci kroz naučni metod uče kritičko razmišljanje i rešavanje kompleksnih problema."
        },
        eksperimenti: {
            predskolci: [
                { n: "Magično mleko", p: "Sipaj mleko u tanjir, dodaj boje i štapić sa deterdžentom.", s: "Deterdžent razbija površinski napon mleka." },
                { n: "Duga od bombona", p: "Poređaj bombone u krug i dodaj toplu vodu.", s: "Šećer i boja se kreću procesom difuzije." },
                { n: "Gumeni medvedići", p: "Stavi ih u običnu i slanu vodu na 24 sata.", s: "Voda ulazi u medvedića kroz proces osmoze." },
                { n: "Balon raketa", p: "Pomešaj sirće u flaši i sodu u balonu, pa navuci.", s: "Hemijska reakcija stvara gas CO2 koji širi balon." },
                { n: "Ples grožđica", p: "Ubaci suve grožđice u čašu kisele vode.", s: "Mehurići gasa podižu grožđice na površinu." }
            ],
            osnovci: [
                { n: "Lava lampa", p: "Pomešaj ulje, vodu, boju i šumeću tabletu.", s: "Razlika u gustini tečnosti i oslobađanje gasa CO2." },
                { n: "Gumeno jaje", p: "Drži jaje u sirćetu 48 sati dok ljuska nestane.", s: "Sirćetna kiselina rastvara kalcijum-karbonat iz ljuske." },
                { n: "Nevidljivo mastilo", p: "Piši limunom i zagrej papir sijalicom ili peglom.", s: "Oksidacija organskih materija pod uticajem toplote." },
                { n: "Telefon na konac", p: "Poveži dve čaše dugačkim koncem.", s: "Prenos zvučnih talasa kroz čvrsta tela (vibracije)." },
                { n: "Veštački sneg", p: "Pomešaj sodu bikarbonu i regenerator za kosu.", s: "Stvaranje polimernih veza." }
            ],
            srednjoskolci: [
                { n: "Izolacija DNK", p: "Zgnječi jagodu, dodaj deterdžent i hladan alkohol.", s: "Liza ćelija i taloženje DNK niti u alkoholu." },
                { n: "Elektroliza", p: "Koristi bateriju od 9V i olovke u slanoj vodi.", s: "Razlaganje molekula vode na vodonik i kiseonik strujom." },
                { n: "Oobleck fluid", p: "Pomešaj skrob i vodu u srazmeri 2:1.", s: "Nenjutnovski fluidi menjaju viskoznost pod silom." },
                { n: "Faradejev kavez", p: "Umotaj telefon u foliju da prekineš signal.", s: "Distribucija naelektrisanja blokira EM talase." },
                { n: "Brzina svetlosti", p: "Meri tačke topljenja čokolade u mikrotalasnoj.", s: "Fizika stojnih talasa i njihova talasna dužina." }
            ]
        }
    };

    // PAMĆENJE KORISNIKA
    window.onload = function() {
        if (localStorage.getItem('stemBazaOtkljucana') === 'true') {
            prikaziBazu(true);
        }
    };

    let qIdx = 0;
    const pitanja = [
        { q: "Pitanje 1: Koji uzrast najčešće podučavate?", a: ["Predškolci", "Mlađi osnovci", "Stariji osnovci"] },
        { q: "Pitanje 2: Koliko vremena imate po sesiji?", a: ["15-30 min", "45-60 min", "Dvočas"] },
        { q: "Pitanje 3: Da li deca rade u grupama?", a: ["Grupno", "Samostalno", "Kombinovano"] },
        { q: "Pitanje 4: Koji efekat želite?", a: ["WOW efekat", "Logika", "Gradnja"] },
        { q: "Pitanje 5: Koliko dece učestvuje?", a: ["Do 5", "5-15", "15+"] },
        { q: "Pitanje 6: Da li mora biti prenosivo?", a: ["Da", "Ne", "Svejedno"] },
        { q: "Pitanje 7: Budžet za materijal?", a: ["Minimalan", "Srednji", "Visok"] },
        { q: "Pitanje 8: Koji tip materijala?", a: ["Kuhinja", "Alati", "Elektronika"] },
        { q: "Pitanje 9: Šta je najveći izazov?", a: ["Ideje", "Teorija", "Oprema"] },
        { q: "Pitanje 10: Vaše iskustvo u STEM radu?", a: ["Početnik", "Napredni", "Stručnjak"] }
    ];

    function startQuiz() {
        document.getElementById('step-0').classList.remove('step-active');
        document.getElementById('step-1').classList.add('step-active');
        prikaziPitanje();
        return true; 
    }

    function prikaziPitanje() {
        const q = pitanja[qIdx];
        document.getElementById('q-progress').innerText = `Pitanje ${qIdx + 1} od 10`;
        document.getElementById('q-text').innerText = q.q;
        const opts = document.getElementById('q-options');
        opts.innerHTML = '';
        q.a.forEach(opt => {
            const btn = document.createElement('button');
            btn.className = "w-full p-4 rounded-2xl border-2 border-gray-100 hover:border-indigo-500 hover:bg-indigo-50 transition-all font-semibold text-gray-700 text-left";
            btn.innerText = opt;
            btn.onclick = sledece;
            opts.appendChild(btn);
        });
    }

    function sledece() {
        qIdx++;
        if (qIdx < pitanja.length) { prikaziPitanje(); } 
        else {
            document.getElementById('step-1').classList.remove('step-active');
            document.getElementById('step-2').classList.add('step-active');
        }
    }

    function prikaziBazu(skipScroll = false) {
        localStorage.setItem('stemBazaOtkljucana', 'true');
        document.getElementById('quiz-container').classList.add('hidden');
        document.getElementById('database-section').classList.remove('hidden');
        if(!skipScroll) window.scrollTo(0,0);
        // Aktivira prvi tab
        prikazi('predskolci', document.querySelector('.cat-btn'));
    }

    function getNedeljniIndeks(max) {
        const d = new Date();
        const start = new Date(d.getFullYear(), 0, 1);
        const diff = Math.floor((d - start) / (24 * 60 * 60 * 1000));
        return Math.ceil(diff / 7) % max;
    }

    function prikazi(kat, btn) {
        document.querySelectorAll('.cat-btn').forEach(b => b.classList.remove('tab-active'));
        if(btn) btn.classList.add('tab-active');
        
        document.getElementById('tekst-vaznosti').innerText = podaci.vaznost[kat];
        const ekran = document.getElementById('ekran');
        ekran.innerHTML = '';

        const idx = getNedeljniIndeks(podaci.eksperimenti[kat].length);
        const expNedelje = podaci.eksperimenti[kat][idx];

        // ZLATNA KARTICA NEDELJE
        ekran.innerHTML += `
            <div class="md:col-span-2 lg:col-span-3 bg-gradient-to-br from-indigo-600 to-indigo-900 p-1 text-white rounded-[3rem] mb-6 shadow-2xl border-4 border-yellow-400">
                <div class="p-8">
                    <span class="bg-yellow-400 text-indigo-900 text-[10px] font-black px-4 py-1.5 rounded-full uppercase mb-4 inline-block tracking-widest italic font-bold">⭐ EKSPERIMENT OVE NEDELJE</span>
                    <h3 class="text-4xl font-bold mb-4 tracking-tight">${expNedelje.n}</h3>
                    <div class="grid md:grid-cols-2 gap-8">
                        <div>
                            <p class="text-indigo-200 text-xs font-black uppercase mb-2 tracking-widest italic">Postupak:</p>
                            <p class="text-white leading-relaxed text-lg">${expNedelje.p}</p>
                        </div>
                        <div class="bg-indigo-800/50 p-6 rounded-3xl border border-indigo-400/30 text-indigo-50 italic">
                            <p class="text-indigo-200 text-xs font-black uppercase mb-2 tracking-widest not-italic">Naučno objašnjenje:</p>
                            ${expNedelje.s}
                        </div>
                    </div>
                </div>
            </div>
        `;

        podaci.eksperimenti[kat].forEach((exp, i) => {
            if(i === idx) return; 
            ekran.innerHTML += `
                <div class="bg-white p-8 rounded-[2.5rem] shadow-xl border border-gray-100 card-hover flex flex-col h-full">
                    <div class="w-14 h-14 bg-indigo-50 text-indigo-600 rounded-2xl flex items-center justify-center mb-6 text-2xl"><i class="fas fa-flask"></i></div>
                    <h3 class="text-2xl font-bold mb-4 text-gray-800 tracking-tight">${exp.n}</h3>
                    <div class="flex-grow">
                        <p class="text-indigo-600 text-xs font-black uppercase tracking-wider mb-2 italic">Postupak:</p>
                        <p class="text-gray-600 leading-relaxed mb-6 text-sm">${exp.p}</p>
                    </div>
                    <div class="bg-indigo-50 p-5 rounded-2xl text-indigo-900 text-sm border border-indigo-100">
                        <span class="font-bold uppercase text-[10px]">Nauka:</span> ${exp.s}
                    </div>
                </div>
            `;
        });
    }
</script>
</body>
</html>
